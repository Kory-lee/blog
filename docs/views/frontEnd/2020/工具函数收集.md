---
title: 工具函数收集
date: 2020-04-05
tags:
  - JavaScript
  - 学习笔记
categories:
  - frontEnd
# publish: false
---

## 第一部分：数组

### 1. `all`: 布尔全等判断

```js
const all = (arr, fn = Boolean) => arr.every(fn);
all([4, 2, 3], (x) => x > 1); // true
all([1, 2, 3]); // true
```

### 2. `allEqual`: 检查数组各项相等

```js
const allEqual = (arr) => arr.every((val) => val === val[0]);
allEqual([1, 2, 3, 4, 5, 6]); //false
```

### 3. `approximatelyEqual`: 约等于

```js
const approximatelyEqual = (v1, v2, epsilon = Number.EPSILON) => Math.abs(v1 - v2) < epsilon;
```

### 4. `average`: 平均数

```js
const average = (...nums) => nums.reduce((acc, val) => acc + val, 0) / nums.length;
```

### 5. `averageBy`: 数组对象属性平均数

```js
const averageBy = (arr, fn) =>
  arr.map(typeof fn === 'function' ? fn : (val) => val[fn]).reduce((acc, val) => acc + val, 0);
```

### 6. `uniqBy`: 数组去重

```js
const uniqBy = (arr, key) => {
  return [...new Map(arr.map((item) => [item[key], item])).values()];
};
// or
const uniqBy = (arr) => [...new Set(arr)];
```

### 7. `bifurcate`: 拆分断言后的数组

```js
const bifurcate = (arr, filter) => arr.reduce((acc, val, i) => acc[filter[i] ? 0 : 1].push(val, acc)[([], [])]);
```

### 8. `compact`: 去除数组中的无效/无用值

```js
const compact = (arr) => arr.filter(Boolean);
```

### 9. `castArray`: 其他类型转数组

```js
const castArray = (val) => (Array.isArray(val) ? val : [val]);
```

### 10. `difference`: 寻找差异

此代码段查找两个数组之间的差异。

```js
const difference = (a, b) => {
  const s = new Set(b);
  return a.filter((x) => s.has(x));
};
```

### 11. `differenceBy`: 先执行在寻找差异

```js
const differenceBy = (a, b, fn) => {
  const s = new Set(b.map(fn));
  return a.filter((x) => !s.has(fn(x)));
};
differenceBy([2.1, 1.2], [2.3, 3.4], Math.floor); // [1.2]
differenceBy([{ x: 2 }, { x: 1 }], [{ x: 1 }], (v) => v.x); // [ { x: 2 } ]
```

## 参考资料

> 其实就是抄笔记

[JavaScript 工具函数大全（新）](https://github.com/roger-hiro/BlogFN/blob/master/JavaScript%20%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0%E5%A4%A7%E5%85%A8%EF%BC%88%E6%96%B0%EF%BC%89.md)